{"version":3,"sources":["webpack:///./src/service/search.js","webpack:///./src/views/Search.vue","webpack:///./src/views/Search.vue?dc8a","webpack:///./src/views/Search.vue?59b9"],"names":["getDefaultKeys","get","getHotKeys","getSearchResult","query","keywords","getSearchDetail","item","ids","id","placeholder","ref","hotArr","resultList","scrollRef","store","useStore","addQuery","newQuery","value","handle","artists","map","singer","name","join","clearQuery","selectItem","result","dispatch","songs","watch","scroll","scrollTo","trim","searchResult","onMounted","defaultKey","data","showKeyword","hotKey","hots","__exports__"],"mappings":"qNAGO,SAASA,IACd,OAAOC,eAAI,mBAIN,SAASC,IACd,OAAOD,eAAI,eAIN,SAASE,EAAgBC,GAC9B,OAAOH,eAAI,UAAW,CACpBI,SAAUD,IAKP,SAASE,EAAgBC,GAC9B,OAAON,eAAI,eAAgB,CACzBO,IAAKD,EAAKE,K,sgBCqBd,IAAMC,EAAcC,iBAAI,IAClBC,EAASD,iBAAI,IACbP,EAAQO,iBAAI,IACZE,EAAaF,iBAAI,IACjBG,EAAYH,iBAAI,MAEhBI,EAAQC,iBAEd,SAASC,EAASC,GAChBd,EAAMe,MAAQD,EAEhB,SAASE,EAAOb,GACd,OAAOA,EAAKc,QAAQC,KAAI,SAACC,GAAD,OAAYA,EAAOC,QAAMC,KAAK,OAExD,SAASC,IACPtB,EAAMe,MAAQ,G,SAGDQ,EAAWA,G,6FAA1B,WAA0BpB,GAA1B,uGACuBD,EAAgBC,GADvC,OACQqB,EADR,OAEEb,EAAMc,SAAS,aAAcD,EAAOE,OAFtC,2C,+BAKAC,mBAAM3B,EAAD,yDAAQ,WAAOc,GAAP,0FACXJ,EAAUK,MAAMa,OAAOC,SAAS,EAAG,GAC9Bf,EAASgB,OAFH,iEAGgB/B,EAAgBe,GAHhC,OAGLiB,EAHK,OAIXtB,EAAWM,MAAQgB,EAAaP,OAAOE,MAJ5B,2CAAR,uDAOLM,uBAAS,wCAAC,sHAEepC,IAFf,cAEJqC,EAFI,OAIR3B,EAAYS,MAAQkB,EAAWC,KAAKC,YAJ5B,SAMWrC,IANX,OAMJsC,EANI,OAOR5B,EAAOO,MAAQqB,EAAOZ,OAAOa,KAPrB,4C,kqDCnEV,MAAMC,EAA2B,IAAgB,EAAQ,CAAC,CAAC,YAAY,qBAExD,gB,kCCRf,W","file":"js/chunk-94b9f598.3bbe6323.js","sourcesContent":["import { get } from './base'\r\n\r\n// 获取默认 推荐歌曲\r\nexport function getDefaultKeys() {\r\n  return get('/search/default')\r\n}\r\n\r\n// 获取 热门推荐列表 \r\nexport function getHotKeys() {\r\n  return get('/search/hot')\r\n}\r\n\r\n// 获取 搜索结果 \r\nexport function getSearchResult(query) {\r\n  return get('/search', {\r\n    keywords: query\r\n  })\r\n}\r\n\r\n// 获取 搜索结果 详情对象 \r\nexport function getSearchDetail(item) {\r\n  return get('/song/detail', {\r\n    ids: item.id\r\n  })\r\n}","<template>\r\n  <div class=\"search\">\r\n    <div class=\"search-input\">\r\n      <i class=\"icon-search\"></i>\r\n      <input class=\"input-inner\" v-model=\"query\" :placeholder=\"placeholder\" />\r\n      <i class=\"icon-dismiss\" v-show=\"query\" @click=\"clearQuery\"></i>\r\n    </div>\r\n    <div class=\"hot-keys\">\r\n      <h1 class=\"title\">热门搜索</h1>\r\n      <ul>\r\n        <li v-for=\"item in hotArr\" ::key=\"item\" class=\"item\">\r\n          <span @click=\"addQuery(item.first)\">{{ item.first }}</span>\r\n        </li>\r\n      </ul>\r\n    </div>\r\n\r\n    <div class=\"search-result\" v-show=\"query.trim()\">\r\n      <Scroll class=\"result-wrapper\" ref=\"scrollRef\">\r\n        <ul>\r\n          <li\r\n            v-for=\"(item, index) in resultList\"\r\n            :key=\"index\"\r\n            @click=\"selectItem(item)\"\r\n          >\r\n            <span>{{ item.name }}</span> -\r\n            <span>{{ handle(item) }}</span>\r\n          </li>\r\n        </ul>\r\n      </Scroll>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script setup>\r\nimport {\r\n  getDefaultKeys,\r\n  getHotKeys,\r\n  getSearchResult,\r\n  getSearchDetail,\r\n} from \"@/service/search\";\r\nimport { onMounted, ref, watch } from \"vue\";\r\nimport Scroll from \"@/components/base/scroll\";\r\nimport { useStore } from \"vuex\";\r\n\r\nconst placeholder = ref(\"\");\r\nconst hotArr = ref([]);\r\nconst query = ref(\"\");\r\nconst resultList = ref([]);\r\nconst scrollRef = ref(null);\r\n\r\nconst store = useStore();\r\n\r\nfunction addQuery(newQuery) {\r\n  query.value = newQuery;\r\n}\r\nfunction handle(item) {\r\n  return item.artists.map((singer) => singer.name).join(\" & \");\r\n}\r\nfunction clearQuery() {\r\n  query.value = \"\";\r\n}\r\n\r\nasync function selectItem(item) {\r\n  const result = await getSearchDetail(item);\r\n  store.dispatch(\"addOnePlay\", result.songs);\r\n}\r\n\r\nwatch(query, async (newQuery) => {\r\n  scrollRef.value.scroll.scrollTo(0, 0);\r\n  if (!newQuery.trim()) return;\r\n  const searchResult = await getSearchResult(newQuery);\r\n  resultList.value = searchResult.result.songs;\r\n});\r\n\r\nonMounted(async () => {\r\n  // 获取默认 推荐歌曲\r\n  let defaultKey = await getDefaultKeys();\r\n  // console.log(defaultKey);\r\n  placeholder.value = defaultKey.data.showKeyword;\r\n  // 获取 热门推荐列表\r\n  let hotKey = await getHotKeys();\r\n  hotArr.value = hotKey.result.hots;\r\n});\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.search-input {\r\n  display: flex;\r\n  align-items: center;\r\n  box-sizing: border-box;\r\n  width: 100%;\r\n  padding: 0 6px;\r\n  height: 32px;\r\n  background: $color-highlight-background;\r\n  border-radius: 6px;\r\n  .icon-search {\r\n    font-size: 24px;\r\n    color: $color-text-d;\r\n  }\r\n  .input-inner {\r\n    flex: 1;\r\n    margin: 0 5px;\r\n    line-height: 18px;\r\n    background: $color-highlight-background;\r\n    color: $color-text;\r\n    font-size: $font-size-medium;\r\n    outline: 0;\r\n    &::placeholder {\r\n      color: $color-text-d;\r\n    }\r\n  }\r\n  .icon-dismiss {\r\n    font-size: 16px;\r\n    color: $color-text-d;\r\n  }\r\n}\r\n.search {\r\n  position: fixed;\r\n  width: 100%;\r\n  top: 88px;\r\n  bottom: 0;\r\n  display: flex;\r\n  box-sizing: border-box;\r\n  flex-direction: column;\r\n  padding: 0 20px;\r\n\r\n  .hot-keys {\r\n    margin-top: 25px;\r\n    .title {\r\n      margin-bottom: 20px;\r\n      font-size: $font-size-medium;\r\n      color: $color-text-ll;\r\n    }\r\n    .item {\r\n      display: inline-block;\r\n      padding: 5px 10px;\r\n      margin: 0 20px 10px 0;\r\n      border-radius: 6px;\r\n      background: $color-highlight-background;\r\n      font-size: $font-size-medium;\r\n      color: $color-text-l;\r\n    }\r\n  }\r\n  .result-wrapper {\r\n    position: absolute;\r\n    bottom: 0;\r\n    top: 10px;\r\n    width: 100%;\r\n    overflow: hidden;\r\n  }\r\n  .search-result {\r\n    position: absolute;\r\n    top: 30px;\r\n    bottom: 0;\r\n    color: $color-text-l;\r\n    background-color: $color-background;\r\n    width: calc(100% - 40px);\r\n    li {\r\n      padding: 5px 30px;\r\n      height: 25px;\r\n      font-size: $font-size-medium;\r\n      @include no-wrap();\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import script from \"./Search.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./Search.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./Search.vue?vue&type=style&index=0&id=f433e7fa&lang=scss&scoped=true\"\n\nimport exportComponent from \"C:\\\\Users\\\\朱雀\\\\Desktop\\\\vue 2-7\\\\31 实战14\\\\vue3_music\\\\node_modules\\\\@vue\\\\cli-service\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-f433e7fa\"]])\n\nexport default __exports__","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--1-1!./Search.vue?vue&type=style&index=0&id=f433e7fa&lang=scss&scoped=true\""],"sourceRoot":""}