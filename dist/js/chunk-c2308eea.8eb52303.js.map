{"version":3,"sources":["webpack:///./src/views/create-detail.js","webpack:///./src/components/base/song-list/index.vue?2a45","webpack:///./src/components/music-list/index.vue?eb82","webpack:///./src/views/AlbumDetail.vue","webpack:///./src/views/AlbumDetail.vue?4714","webpack:///./src/components/base/song-list/index.vue","webpack:///./src/components/base/song-list/index.vue?cc85","webpack:///./src/views/AlbumDetail.vue?aef0","webpack:///./src/components/music-list/index.vue","webpack:///./src/components/music-list/index.vue?8a36","webpack:///./src/service/recommend.js"],"names":["createDetail","props","sessionKey","getApi","route","useRoute","router","useRouter","songs","ref","loading","computedData","computed","result","data","detailObj","id","cached","storage","getLocal","params","picUrl","value","listTitle","name","onMounted","push","path","matched","hotSongs","getAlbum","__exports__","store","useStore","handle","item","ar","map","nameObj","join","addOne","song","dispatch","imageHeight","imageRef","maxTranslateY","scrollY","playlist","state","bgImageStyle","height","zIndex","scale","backgroundImage","transform","playBtnStyle","display","scrollStyle","top","bottom","length","filterStyle","blur","Math","min","backdropFilter","onScroll","pos","y","goBack","go","addAll","clientHeight","getRecommend","get","type","getRecommendAlbum","limit","album","albumListId","trackIds","ablumArr","promiseArr","forEach","Promise","resolve","reject","getAlbumDetail","all","then","ids"],"mappings":"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","file":"js/chunk-c2308eea.8eb52303.js","sourcesContent":["import { computed, onMounted, ref } from \"vue\";\r\nimport storage from \"@/assets/js/storage-api\";\r\nimport { useRoute, useRouter } from \"vue-router\";\r\n\r\nexport default function createDetail(props, sessionKey, getApi) {\r\n  const route = useRoute();\r\n  const router = useRouter();\r\n  const songs = ref([]);\r\n  const loading = ref(true);\r\n\r\n  const computedData = computed(() => {\r\n    let result = null;\r\n    const data = props.detailObj;\r\n    if (data.id) {\r\n      //props获取成功\r\n      result = data;\r\n    } else {\r\n      //props获取上失败\r\n      const cached = storage.getLocal(sessionKey);\r\n      //存储的值 存在 且 和路由上的 id保持一致\r\n      if (cached && cached.id === route.params.id / 1) {\r\n        result = cached;\r\n      }\r\n    }\r\n    return result;\r\n  });\r\n\r\n  //背景图片\r\n  const picUrl = computed(() => {\r\n    return computedData.value ? computedData.value.picUrl : \"\";\r\n  });\r\n  //标题\r\n  const listTitle = computed(() => {\r\n    return computedData.value ? computedData.value.name : \"\";\r\n  });\r\n\r\n  onMounted(async () => {\r\n    const data = computedData.value;\r\n    // props内 和本地存储内都没有数据\r\n    if (!data) {\r\n      // 跳转回singer页面\r\n      router.push({ path: route.matched[0].path });\r\n      return;\r\n    }\r\n\r\n    const result = await getApi(data);\r\n    songs.value = result.hotSongs;\r\n    loading.value = false;\r\n  });\r\n\r\n  return {\r\n    picUrl,\r\n    loading,\r\n    songs,\r\n    listTitle\r\n  }\r\n\r\n}","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--1-1!./index.vue?vue&type=style&index=0&id=abdbb7fa&lang=scss&scoped=true\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--1-1!./index.vue?vue&type=style&index=0&id=5e3f6078&lang=scss&scoped=true\"","<template>\r\n  <div class=\"singer-detail\">\r\n    <MusicList\r\n      :picUrl=\"picUrl\"\r\n      :listTitle=\"listTitle\"\r\n      :songs=\"songs\"\r\n      :loading=\"loading\"\r\n    ></MusicList>\r\n  </div>\r\n</template>\r\n<script setup>\r\nimport MusicList from \"@/components/music-list\";\r\nimport { getAlbum } from \"@/service/recommend\";\r\nimport createDetail from \"./create-detail\";\r\n\r\nconst props = defineProps([\"detailObj\"]);\r\n\r\nconst { picUrl, loading, songs, listTitle } = createDetail(\r\n  props,\r\n  \"__albumDetail__\",\r\n  getAlbum\r\n);\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.singer-detail {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  bottom: 0;\r\n  right: 0;\r\n  background: $color-background;\r\n  z-index: 1;\r\n}\r\n</style>\r\n","import script from \"./AlbumDetail.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./AlbumDetail.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./AlbumDetail.vue?vue&type=style&index=0&id=4fd7996e&lang=scss&scoped=true\"\n\nimport exportComponent from \"C:\\\\Users\\\\朱雀\\\\Desktop\\\\vue 2-7\\\\31 实战14\\\\vue3_music\\\\node_modules\\\\@vue\\\\cli-service\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-4fd7996e\"]])\n\nexport default __exports__","<template>\r\n  <ul class=\"song-list\">\r\n    <li class=\"item\" v-for=\"item in songs\" :key=\"item.id\" @click=\"addOne(item)\">\r\n      <div class=\"content\">\r\n        <h2 class=\"name\">{{ item.name }}</h2>\r\n        <p class=\"desc\">{{ handle(item) }}</p>\r\n      </div>\r\n    </li>\r\n  </ul>\r\n</template>\r\n<script setup>\r\nimport { useStore } from \"vuex\";\r\nconst store = useStore();\r\nconst props = defineProps({\r\n  songs: {\r\n    type: Array,\r\n    default: [],\r\n  },\r\n});\r\n\r\nfunction handle(item) {\r\n  return item.ar\r\n    .map((nameObj) => {\r\n      return nameObj.name;\r\n    })\r\n    .join(\"-\");\r\n}\r\n\r\nfunction addOne(song) {\r\n  store.dispatch(\"addOnePlay\", [song]);\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.song-list {\r\n  .item {\r\n    display: flex;\r\n    align-items: center;\r\n    box-sizing: border-box;\r\n    height: 64px;\r\n    font-size: $font-size-medium;\r\n    .content {\r\n      flex: 1;\r\n      line-height: 20px;\r\n      overflow: hidden;\r\n      .name {\r\n        @include no-wrap();\r\n        color: $color-text-ll;\r\n      }\r\n      .desc {\r\n        @include no-wrap();\r\n        margin-top: 4px;\r\n        color: $color-text-d;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import script from \"./index.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=abdbb7fa&lang=scss&scoped=true\"\n\nimport exportComponent from \"C:\\\\Users\\\\朱雀\\\\Desktop\\\\vue 2-7\\\\31 实战14\\\\vue3_music\\\\node_modules\\\\@vue\\\\cli-service\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-abdbb7fa\"]])\n\nexport default __exports__","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--1-1!./AlbumDetail.vue?vue&type=style&index=0&id=4fd7996e&lang=scss&scoped=true\"","<template>\r\n  <div class=\"music-list\">\r\n    <div class=\"back\" @click=\"goBack\">\r\n      <i class=\"icon-back\"></i>\r\n    </div>\r\n    <h1 class=\"title\">{{ listTitle }}</h1>\r\n    <div class=\"bg-image\" :style=\"bgImageStyle\" ref=\"imageRef\">\r\n      <div class=\"play-btn-wrapper\" :style=\"playBtnStyle\">\r\n        <div class=\"play-btn\" v-show=\"songs.length > 0\">\r\n          <i class=\"icon-play\"></i>\r\n          <span class=\"text\" @click=\"addAll\">顺序播放全部</span>\r\n        </div>\r\n      </div>\r\n      <div class=\"filter\" :style=\"filterStyle\"></div>\r\n    </div>\r\n    <scroll class=\"list\" :probeType=\"3\" :style=\"scrollStyle\" @scroll=\"onScroll\">\r\n      <div class=\"song-list-wrapper\" v-loading=\"loading\">\r\n        <SongList :songs=\"songs\"></SongList>\r\n      </div>\r\n    </scroll>\r\n  </div>\r\n</template>\r\n<script setup>\r\nimport { computed, onMounted, ref } from \"vue\";\r\nimport SongList from \"@/components/base/song-list\";\r\nimport Scroll from \"@/components/base/scroll\";\r\nimport { useRouter } from \"vue-router\";\r\nimport { useStore } from \"vuex\";\r\nconst props = defineProps({\r\n  songs: {\r\n    type: Array,\r\n    default: [],\r\n  },\r\n  listTitle: String,\r\n  picUrl: String,\r\n  loading: Boolean,\r\n});\r\nconst router = useRouter();\r\nconst store = useStore();\r\n\r\nconst imageHeight = ref(0);\r\nconst imageRef = ref(null);\r\nconst maxTranslateY = ref(0);\r\nconst scrollY = ref(0);\r\nconst playlist = computed(() => store.state.playlist);\r\nconst bgImageStyle = computed(() => {\r\n  let height = \"40%\";\r\n  let zIndex = 0;\r\n  let scale = 1;\r\n  if (scrollY.value > maxTranslateY.value) {\r\n    //触发了滚动临界\r\n    height = \"40px\";\r\n    zIndex = 1;\r\n  }\r\n\r\n  //下拉列表时\r\n  if (scrollY.value < 0) {\r\n    //往下拉了多少 bgImage  放大多少 transform scale(1.2) 1 原本的大小 0.2 * 原本的宽高 = 放大的量\r\n    // -scrollY.value = bgImage放大的量 = (???)* bgImage原本的高度\r\n    scale = -scrollY.value / imageHeight.value + 1;\r\n  }\r\n\r\n  return {\r\n    backgroundImage: `url(${props.picUrl})`,\r\n    height,\r\n    zIndex,\r\n    transform: `scale(${scale})`,\r\n  };\r\n});\r\n\r\nconst playBtnStyle = computed(() => {\r\n  let display = \"block\";\r\n  if (scrollY.value > maxTranslateY.value) {\r\n    display = \"none\";\r\n  }\r\n  return {\r\n    display,\r\n  };\r\n});\r\n\r\nconst scrollStyle = computed(() => {\r\n  //scroll 的top值 就是 bg-image的高度\r\n  return {\r\n    top: `${imageHeight.value}px`,\r\n    bottom: playlist.value.length ? \"60px\" : 0,\r\n  };\r\n});\r\nconst filterStyle = computed(() => {\r\n  let blur = 0;\r\n  if (scrollY.value > 0) {\r\n    blur = Math.min(scrollY.value / 25, 10);\r\n  }\r\n\r\n  return {\r\n    backdropFilter: `blur(${blur}px)`,\r\n  };\r\n});\r\n\r\nfunction onScroll(pos) {\r\n  scrollY.value = -pos.y;\r\n}\r\nfunction goBack() {\r\n  router.go(-1);\r\n}\r\nfunction addAll() {\r\n  store.dispatch(\"addAllPlay\", props.songs);\r\n}\r\nonMounted(() => {\r\n  //获取背景div的高度\r\n  imageHeight.value = imageRef.value.clientHeight;\r\n  maxTranslateY.value = imageHeight.value - 40;\r\n});\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.music-list {\r\n  position: fixed;\r\n  width: 100%;\r\n  top: 0;\r\n  bottom: 0;\r\n  .back {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 6px;\r\n    z-index: 20;\r\n    transform: translateZ(2px);\r\n    .icon-back {\r\n      display: block;\r\n      padding: 10px;\r\n      font-size: $font-size-large-x;\r\n      color: $color-theme;\r\n    }\r\n  }\r\n  .title {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 10%;\r\n    width: 80%;\r\n    z-index: 20;\r\n    transform: translateZ(2px);\r\n    @include no-wrap();\r\n    text-align: center;\r\n    line-height: 40px;\r\n    font-size: $font-size-large;\r\n    color: $color-text;\r\n  }\r\n  .bg-image {\r\n    position: relative;\r\n    width: 100%;\r\n    height: 40%;\r\n    transform-origin: top;\r\n    background-size: cover;\r\n    .play-btn-wrapper {\r\n      position: absolute;\r\n      bottom: 20px;\r\n      z-index: 10;\r\n      width: 100%;\r\n      .play-btn {\r\n        box-sizing: border-box;\r\n        width: 135px;\r\n        padding: 7px 0;\r\n        margin: 0 auto;\r\n        text-align: center;\r\n        border: 1px solid $color-theme;\r\n        color: $color-theme;\r\n        border-radius: 100px;\r\n        font-size: 0;\r\n      }\r\n      .icon-play {\r\n        display: inline-block;\r\n        vertical-align: middle;\r\n        margin-right: 6px;\r\n        font-size: $font-size-medium-x;\r\n      }\r\n      .text {\r\n        display: inline-block;\r\n        vertical-align: middle;\r\n        font-size: $font-size-small;\r\n      }\r\n    }\r\n    .filter {\r\n      position: absolute;\r\n      top: 0;\r\n      left: 0;\r\n      width: 100%;\r\n      height: 100%;\r\n      background: rgba(7, 17, 27, 0.4);\r\n    }\r\n  }\r\n  .list {\r\n    position: absolute;\r\n    bottom: 0;\r\n    width: 100%;\r\n    z-index: 0;\r\n    .song-list-wrapper {\r\n      padding: 20px 30px;\r\n      min-height: 350px;\r\n      background: $color-background;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import script from \"./index.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=5e3f6078&lang=scss&scoped=true\"\n\nimport exportComponent from \"C:\\\\Users\\\\朱雀\\\\Desktop\\\\vue 2-7\\\\31 实战14\\\\vue3_music\\\\node_modules\\\\@vue\\\\cli-service\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-5e3f6078\"]])\n\nexport default __exports__","import { get } from './base'\r\n\r\n//请求轮播数据 \r\nexport function getRecommend() {\r\n  // 直接定义 接口   \r\n  return get('/banner', {\r\n    type: 2\r\n  })\r\n}\r\n\r\n//请求 歌单数据 \r\nexport function getRecommendAlbum() {\r\n  // 直接定义 接口   \r\n  return get('/top/playlist', {\r\n    limit: 30\r\n  })\r\n}\r\n\r\n// 获取歌单详情 \r\nexport async function getAlbum(album) {\r\n  let result = await get('/playlist/detail', {\r\n    id: album.id\r\n  })\r\n  let albumListId = result.playlist.trackIds\r\n  albumListId.length = Math.min(50, albumListId.length)\r\n\r\n  let ablumArr = []\r\n  let promiseArr = []\r\n\r\n  albumListId.forEach(item => {\r\n    promiseArr.push(new Promise((resolve, reject) => {\r\n      getAlbumDetail(item, ablumArr, resolve)\r\n    }))\r\n  });\r\n\r\n  return Promise.all(promiseArr).then(() => {\r\n    return {\r\n      hotSongs: ablumArr\r\n    }\r\n  })\r\n}\r\n\r\nfunction getAlbumDetail(item, ablumArr, resolve) {\r\n  //根据 id 请求 完整的 歌曲对象 \r\n  get('/song/detail', {\r\n    ids: item.id\r\n  }).then(result => {\r\n    ablumArr.push(result.songs[0])\r\n    resolve()\r\n  })\r\n}"],"sourceRoot":""}